# **Проект: Электронная таблица**

Проект **Spreadsheet** представляет собой реализацию простой электронной таблицы, аналогичной тем, что используются в таких приложениях, как **Microsoft Excel** или **Google Sheets**. Основная цель проекта — предоставить функциональность для работы с ячейками, формулами и их вычислениями, а также обеспечить возможность печати и отображения данных в табличном формате. Проект разработан на языке **C++** с использованием стандарта **C++17** и включает в себя несколько ключевых компонентов, таких как парсер формул, обработка ошибок и управление зависимостями между ячейками.

---

## **Основные возможности проекта**

### **1. Работа с ячейками**
- Ячейки могут содержать текстовые данные, числа или формулы.
- Формулы поддерживают базовые арифметические операции (сложение, вычитание, умножение, деление) и ссылки на другие ячейки.
- Ячейки могут быть очищены, что приводит к удалению их содержимого.

### **2. Формулы и их вычисление**
- Формулы начинаются с символа `=` и могут включать ссылки на другие ячейки (например, `=A1+B2`).
- Поддерживаются унарные и бинарные операции, а также приоритет операций (например, умножение и деление выполняются перед сложением и вычитанием).
- Формулы могут быть вложенными, что позволяет создавать сложные выражения.

### **3. Обработка ошибок**
- Проект включает обработку различных типов ошибок, таких как:
  - Деление на ноль.
  - Ссылки на несуществующие ячейки.
  - Циклические зависимости.
- В случае ошибки в формуле, ячейка возвращает соответствующее сообщение об ошибке (например, `#VALUE!` или `#ARITHM!`).

### **4. Зависимости между ячейками**
- Проект поддерживает отслеживание зависимостей между ячейками.
- Если ячейка содержит формулу, которая ссылается на другие ячейки, то при изменении этих ячеек автоматически пересчитывается значение формулы.
- Реализована проверка на циклические зависимости, чтобы предотвратить бесконечные циклы при вычислении формул.

### **5. Печать и отображение данных**
- Проект предоставляет возможность печати данных в текстовом формате, где:
  - Столбцы разделены табуляцией.
  - Строки разделены символами перевода строки.
- Поддерживается печать как текстового содержимого ячеек, так и их вычисленных значений.

### **6. Парсер формул**
- Для обработки формул используется **ANTLR** (Another Tool for Language Recognition), который позволяет анализировать и интерпретировать выражения.
- Грамматика формул описана в файле `Formula.g4`, который определяет правила для разбора арифметических выражений и ссылок на ячейки.

### **7. Тестирование**
- Проект включает набор тестов, которые проверяют корректность работы всех основных функций, таких как:
  - Вычисление формул.
  - Обработка ошибок.
  - Работа с ячейками.
  - Печать данных.
- Тесты написаны с использованием фреймворка **TestRunner**, который позволяет автоматизировать проверку функциональности и выявлять ошибки.

---

## **Архитектура проекта**

Проект состоит из нескольких ключевых классов и модулей:

### **1. `Cell` (Ячейка)**
- Класс, представляющий ячейку таблицы.
- Ячейка может содержать текст, число или формулу.
- Класс также отвечает за вычисление значений формул и управление зависимостями между ячейками.

### **2. `Sheet` (Таблица)**
- Класс, представляющий электронную таблицу.
- Управляет ячейками, предоставляет методы для установки и очистки содержимого ячеек, а также для печати данных.

### **3. `FormulaAST` (Абстрактное синтаксическое дерево формулы)**
- Класс, который представляет формулу в виде дерева, что позволяет эффективно вычислять её значение.

### **4. `FormulaParser` (Парсер формул)**
- Модуль, который анализирует строки с формулами и преобразует их в абстрактное синтаксическое дерево.

### **5. `TestRunner` (Тестовый фреймворк)**
- Фреймворк для запуска тестов и проверки корректности работы всех компонентов проекта.

---

## **Использование**

Проект может быть использован:
- Как основа для создания более сложных электронных таблиц.
- Как учебный пример для изучения работы с формулами, парсерами и зависимостями в **C++**.
- Может быть расширен для поддержки дополнительных функций, таких как:
  - Графическое отображение таблицы.
  - Поддержка более сложных формул.
  - Интеграция с другими системами.

---

## **Установка и сборка**

Проект использует **CMake** для сборки. Для работы с **ANTLR** требуется наличие **Java** и файла `antlr-4.12.0-complete.jar`. После настройки **CMake** проект может быть собран с помощью стандартных команд:

```bash
mkdir build
cd build
cmake ..
make
```

---

## **Заключение**

Проект **Spreadsheet** представляет собой мощный инструмент для работы с электронными таблицами, который может быть использован как для учебных целей, так и для создания более сложных приложений. Благодаря поддержке формул, обработке ошибок и зависимостям между ячейками, он предоставляет базовую функциональность, необходимую для работы с табличными данными.
